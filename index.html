<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grade Analyzer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .fade-in { animation: fadeIn 0.3s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        /* Hide scrollbar for number inputs */
        input[type=number]::-webkit-inner-spin-button, 
        input[type=number]::-webkit-outer-spin-button { -webkit-appearance: none; margin: 0; }
    </style>
</head>
<body class="min-h-screen bg-gray-50 p-4 text-gray-800">

    <div class="max-w-md mx-auto bg-white rounded-2xl shadow-xl overflow-hidden">
        
        <!-- Header -->
        <div class="bg-indigo-600 p-6 text-white text-center">
            <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mx-auto mb-2 opacity-90"><rect width="16" height="20" x="4" y="2" rx="2"/><line x1="8" x2="16" y1="6" y2="6"/><line x1="16" x2="16" y1="14" y2="18"/><path d="M16 10h.01"/><path d="M12 10h.01"/><path d="M8 10h.01"/><path d="M12 14h.01"/><path d="M8 14h.01"/><path d="M12 18h.01"/><path d="M8 18h.01"/></svg>
            <h1 class="text-2xl font-bold">Grade Analyzer</h1>
            <p class="text-indigo-200 text-sm mt-1">Check standard university passing criteria</p>
        </div>

        <!-- Course Type Selector -->
        <div class="p-4 grid grid-cols-3 gap-2 bg-indigo-50 border-b border-indigo-100" id="tab-container">
            <button onclick="setCourseType('theory')" id="btn-theory" class="tab-btn flex flex-col items-center p-2 rounded-lg transition-all text-xs font-medium bg-indigo-600 text-white shadow-md scale-105">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mb-1"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>
                Theory
            </button>
            <button onclick="setCourseType('practical')" id="btn-practical" class="tab-btn flex flex-col items-center p-2 rounded-lg transition-all text-xs font-medium bg-white text-gray-500 hover:bg-indigo-100">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mb-1"><path d="M10 2v7.31"/><path d="M14 9.3V1.99"/><path d="M8.5 2h7"/><path d="M14 9.3a6.5 6.5 0 1 1-4 0"/><path d="M5.52 16h12.96"/></svg>
                Practical
            </button>
            <button onclick="setCourseType('integrated')" id="btn-integrated" class="tab-btn flex flex-col items-center p-2 rounded-lg transition-all text-xs font-medium bg-white text-gray-500 hover:bg-indigo-100">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mb-1"><path d="m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z"/><path d="m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65"/><path d="m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65"/></svg>
                Both
            </button>
        </div>

        <!-- Input Form -->
        <div class="p-6 space-y-4">
            <p class="text-xs text-gray-400 uppercase tracking-wider font-semibold mb-2">Enter Weightage (Marks)</p>

            <div id="inputs-container" class="space-y-3">
                <!-- Rows will be dynamically updated based on visibility -->
                
                <!-- Attendance -->
                <div class="input-row flex items-center space-x-3" id="row-attendance">
                    <div class="flex-1">
                        <label class="block text-xs font-medium text-gray-600 mb-1">Attendance</label>
                        <input type="number" id="attendance" placeholder="0" class="w-full bg-gray-50 border border-gray-300 rounded-lg px-3 py-2 text-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-colors">
                    </div>
                    <div class="w-20">
                        <label class="block text-xs font-medium text-gray-400 mb-1 text-center">Max</label>
                        <input type="number" id="attendance-max" value="5" class="w-full bg-white border border-gray-200 rounded-lg px-2 py-2 text-sm text-center text-gray-500 focus:outline-none focus:ring-1 focus:ring-indigo-300">
                    </div>
                </div>

                <!-- CA -->
                <div class="input-row flex items-center space-x-3" id="row-ca">
                    <div class="flex-1">
                        <label class="block text-xs font-medium text-gray-600 mb-1">Continuous Assessment (CA)</label>
                        <input type="number" id="ca" placeholder="0" class="w-full bg-gray-50 border border-gray-300 rounded-lg px-3 py-2 text-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-colors">
                    </div>
                    <div class="w-20">
                        <label class="block text-xs font-medium text-gray-400 mb-1 text-center">Max</label>
                        <input type="number" id="ca-max" value="25" class="w-full bg-white border border-gray-200 rounded-lg px-2 py-2 text-sm text-center text-gray-500 focus:outline-none focus:ring-1 focus:ring-indigo-300">
                    </div>
                </div>

                <!-- MTE -->
                <div class="input-row flex items-center space-x-3" id="row-mte">
                    <div class="flex-1">
                        <label class="block text-xs font-medium text-gray-600 mb-1">Mid Term Exam (MTE)</label>
                        <input type="number" id="mte" placeholder="0" class="w-full bg-gray-50 border border-gray-300 rounded-lg px-3 py-2 text-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-colors">
                    </div>
                    <div class="w-20">
                        <label class="block text-xs font-medium text-gray-400 mb-1 text-center">Max</label>
                        <input type="number" id="mte-max" value="20" class="w-full bg-white border border-gray-200 rounded-lg px-2 py-2 text-sm text-center text-gray-500 focus:outline-none focus:ring-1 focus:ring-indigo-300">
                    </div>
                </div>

                <!-- ETE Obj -->
                <div class="input-row flex items-center space-x-3" id="row-eteObj">
                    <div class="flex-1">
                        <label class="block text-xs font-medium text-gray-600 mb-1">End Term (Objective)</label>
                        <input type="number" id="eteObj" placeholder="0" class="w-full bg-gray-50 border border-gray-300 rounded-lg px-3 py-2 text-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-colors">
                    </div>
                    <div class="w-20">
                        <label class="block text-xs font-medium text-gray-400 mb-1 text-center">Max</label>
                        <input type="number" id="eteObj-max" value="15" class="w-full bg-white border border-gray-200 rounded-lg px-2 py-2 text-sm text-center text-gray-500 focus:outline-none focus:ring-1 focus:ring-indigo-300">
                    </div>
                </div>

                <!-- ETE Theory -->
                <div class="input-row flex items-center space-x-3" id="row-eteTheory">
                    <div class="flex-1">
                        <label class="block text-xs font-medium text-gray-600 mb-1">End Term (Theory)</label>
                        <input type="number" id="eteTheory" placeholder="0" class="w-full bg-gray-50 border border-gray-300 rounded-lg px-3 py-2 text-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-colors">
                    </div>
                    <div class="w-20">
                        <label class="block text-xs font-medium text-gray-400 mb-1 text-center">Max</label>
                        <input type="number" id="eteTheory-max" value="35" class="w-full bg-white border border-gray-200 rounded-lg px-2 py-2 text-sm text-center text-gray-500 focus:outline-none focus:ring-1 focus:ring-indigo-300">
                    </div>
                </div>

                 <!-- ETE Practical -->
                 <div class="input-row flex items-center space-x-3 hidden" id="row-etePrac">
                    <div class="flex-1">
                        <label class="block text-xs font-medium text-gray-600 mb-1">End Term (Practical)</label>
                        <input type="number" id="etePrac" placeholder="0" class="w-full bg-gray-50 border border-gray-300 rounded-lg px-3 py-2 text-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-colors">
                    </div>
                    <div class="w-20">
                        <label class="block text-xs font-medium text-gray-400 mb-1 text-center">Max</label>
                        <input type="number" id="etePrac-max" value="50" class="w-full bg-white border border-gray-200 rounded-lg px-2 py-2 text-sm text-center text-gray-500 focus:outline-none focus:ring-1 focus:ring-indigo-300">
                    </div>
                </div>

            </div>

            <button onclick="calculateResult()" class="w-full mt-6 bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-4 rounded-xl shadow-lg transform active:scale-95 transition-all flex items-center justify-center gap-2">
                Check Result
            </button>
            <button onclick="resetForm()" class="w-full mt-2 bg-white hover:bg-gray-50 text-gray-500 font-medium py-2 px-4 rounded-xl border border-gray-200 flex items-center justify-center gap-2 text-sm">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/></svg>
                Reset
            </button>
        </div>

        <!-- Result Section -->
        <div id="result-container" class="bg-gray-100 p-6 border-t border-gray-200 hidden fade-in">
            <div id="status-card" class="rounded-xl p-5 text-center shadow-sm border-2 mb-4">
                <div id="status-icon" class="mx-auto mb-2 flex justify-center"></div>
                <h2 id="status-text" class="text-3xl font-bold tracking-tight"></h2>
                <p id="total-score-text" class="text-lg font-medium opacity-90 mt-1"></p>
            </div>

            <div id="details-container" class="space-y-2">
                <!-- Dynamic content injected here -->
            </div>
        </div>

    </div>

    <script>
        let currentType = 'theory';

        const defaultMaxValues = {
            theory: { attendance: 5, ca: 25, mte: 20, eteObj: 15, eteTheory: 35, etePrac: 0 },
            practical: { attendance: 5, ca: 45, mte: 0, eteObj: 0, eteTheory: 0, etePrac: 50 },
            integrated: { attendance: 5, ca: 20, mte: 15, eteObj: 10, eteTheory: 20, etePrac: 30 }
        };

        function setCourseType(type) {
            currentType = type;
            
            // Update Tab UI
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.className = 'tab-btn flex flex-col items-center p-2 rounded-lg transition-all text-xs font-medium bg-white text-gray-500 hover:bg-indigo-100';
            });
            const activeBtn = document.getElementById(`btn-${type}`);
            activeBtn.className = 'tab-btn flex flex-col items-center p-2 rounded-lg transition-all text-xs font-medium bg-indigo-600 text-white shadow-md scale-105';

            // Show/Hide Fields
            const rows = {
                attendance: true,
                ca: true,
                mte: type !== 'practical',
                eteObj: type !== 'practical',
                eteTheory: type !== 'practical',
                etePrac: type !== 'theory'
            };

            for (const [key, visible] of Object.entries(rows)) {
                const el = document.getElementById(`row-${key}`);
                if (visible) el.classList.remove('hidden');
                else el.classList.add('hidden');
            }

            // Reset Result
            document.getElementById('result-container').classList.add('hidden');
            
            // Set Default Max Values for the type
            const defaults = defaultMaxValues[type];
            for (const [key, val] of Object.entries(defaults)) {
                const maxEl = document.getElementById(`${key}-max`);
                if(maxEl) maxEl.value = val;
            }
            
            // Clear inputs
            document.querySelectorAll('input[placeholder="0"]').forEach(input => input.value = '');
        }

        function getVal(id) {
            return parseFloat(document.getElementById(id).value) || 0;
        }

        function calculateResult() {
            // Get Values
            const att = getVal('attendance');
            const ca = getVal('ca');
            const mte = getVal('mte');
            const eteObj = getVal('eteObj');
            const eteTheory = getVal('eteTheory');
            const etePrac = getVal('etePrac');

            const attMax = getVal('attendance-max');
            const caMax = getVal('ca-max');
            const mteMax = getVal('mte-max');
            const eteObjMax = getVal('eteObj-max');
            const eteTheoryMax = getVal('eteTheory-max');
            const etePracMax = getVal('etePrac-max');

            const totalObtained = att + ca + mte + eteObj + eteTheory + etePrac;
            const totalMax = attMax + caMax + mteMax + eteObjMax + eteTheoryMax + etePracMax;
            const totalPercent = totalMax > 0 ? (totalObtained / totalMax) * 100 : 0;

            let status = 'FAIL';
            let reasons = [];
            let passedConditions = [];

            // --- Logic ---
            if (currentType === 'theory') {
                const eteObtained = eteObj + eteTheory;
                const eteMax = eteObjMax + eteTheoryMax;
                const etePercent = eteMax > 0 ? (eteObtained / eteMax) * 100 : 0;

                const combinedObtained = eteObtained + mte;
                const combinedMax = eteMax + mteMax;
                const combinedPercent = combinedMax > 0 ? (combinedObtained / combinedMax) * 100 : 0;

                const passedComponentRule = (etePercent >= 30) || (combinedPercent >= 30);
                const passedOverall = totalPercent >= 40;

                if (!passedComponentRule) {
                    reasons.push(`Failed ETE criteria. ETE: ${etePercent.toFixed(1)}% (<30%) AND Combined: ${combinedPercent.toFixed(1)}% (<30%).`);
                } else {
                    if (etePercent >= 30) passedConditions.push(`Passed ETE threshold (${etePercent.toFixed(1)}%)`);
                    else passedConditions.push(`Saved by Combined MTE+ETE rule (${combinedPercent.toFixed(1)}%)`);
                }

                if (!passedOverall) reasons.push(`Total aggregate is ${totalPercent.toFixed(1)}% (Needed 40%).`);
                status = (passedComponentRule && passedOverall) ? 'PASS' : 'FAIL';

            } else if (currentType === 'practical') {
                const pracPercent = etePracMax > 0 ? (etePrac / etePracMax) * 100 : 0;
                const passedPrac = pracPercent >= 30;
                const passedOverall = totalPercent >= 40;

                if (!passedPrac) reasons.push(`End Term Practical is ${pracPercent.toFixed(1)}% (Needed 30%).`);
                if (!passedOverall) reasons.push(`Total aggregate is ${totalPercent.toFixed(1)}% (Needed 40%).`);
                status = (passedPrac && passedOverall) ? 'PASS' : 'FAIL';

            } else if (currentType === 'integrated') {
                const theoryEteObtained = eteObj + eteTheory;
                const theoryEteMax = eteObjMax + eteTheoryMax;
                const theoryEtePercent = theoryEteMax > 0 ? (theoryEteObtained / theoryEteMax) * 100 : 0;

                const combinedObtained = theoryEteObtained + mte;
                const combinedMax = theoryEteMax + mteMax;
                const combinedPercent = combinedMax > 0 ? (combinedObtained / combinedMax) * 100 : 0;

                const passedTheoryRule = (theoryEtePercent >= 30) || (combinedPercent >= 30);

                const pracPercent = etePracMax > 0 ? (etePrac / etePracMax) * 100 : 0;
                const passedPracRule = pracPercent >= 30;
                const passedOverall = totalPercent >= 40;

                if (!passedTheoryRule) reasons.push(`Failed Theory criteria. Theory ETE: ${theoryEtePercent.toFixed(1)}%, Combined: ${combinedPercent.toFixed(1)}%.`);
                else {
                    if (theoryEtePercent < 30) passedConditions.push(`Saved by Combined MTE+Theory rule (${combinedPercent.toFixed(1)}%)`);
                }

                if (!passedPracRule) reasons.push(`Failed Practical End Term criteria (${pracPercent.toFixed(1)}% < 30%).`);
                if (!passedOverall) reasons.push(`Total aggregate is ${totalPercent.toFixed(1)}% (Needed 40%).`);

                status = (passedTheoryRule && passedPracRule && passedOverall) ? 'PASS' : 'FAIL';
            }

            // Render Results
            renderResult(status, totalObtained, totalPercent, reasons, passedConditions);
        }

        function renderResult(status, score, percent, reasons, conditions) {
            const container = document.getElementById('result-container');
            const card = document.getElementById('status-card');
            const iconDiv = document.getElementById('status-icon');
            const detailsDiv = document.getElementById('details-container');

            container.classList.remove('hidden');

            // Set Card Style
            if (status === 'PASS') {
                card.className = 'rounded-xl p-5 text-center shadow-sm border-2 mb-4 bg-green-50 border-green-200 text-green-800';
                iconDiv.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="#22c55e" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>`;
            } else {
                card.className = 'rounded-xl p-5 text-center shadow-sm border-2 mb-4 bg-red-50 border-red-200 text-red-800';
                iconDiv.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="#ef4444" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="15" x2="9" y1="9" y2="15"/><line x1="9" x2="15" y1="9" y2="15"/></svg>`;
            }

            document.getElementById('status-text').innerText = status;
            document.getElementById('total-score-text').innerText = `Total: ${score.toFixed(1)} / ${percent.toFixed(1)}%`;

            // Build Details HTML
            let html = '';
            
            if (status === 'PASS') {
                if (conditions.length > 0) {
                    html += `
                    <div class="text-sm bg-white p-3 rounded-lg border border-green-100 shadow-sm">
                        <p class="font-semibold text-green-700 mb-1">How you passed:</p>
                        <ul class="list-disc list-inside text-gray-600 space-y-1">
                            ${conditions.map(c => `<li>${c}</li>`).join('')}
                            <li>Total Aggregate â‰¥ 40%</li>
                        </ul>
                    </div>`;
                }
                if (percent < 45) {
                    html += `
                    <div class="flex items-start gap-2 text-xs text-orange-600 bg-orange-50 p-2 rounded mt-2">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"/><line x1="12" x2="12" y1="9" y2="13"/><line x1="12" x2="12.01" y1="17" y2="17"/></svg>
                        <p>Close call! You passed, but just barely above the 40% aggregate threshold.</p>
                    </div>`;
                }
            } else {
                html += `
                <div class="text-sm bg-white p-3 rounded-lg border border-red-100 shadow-sm">
                    <p class="font-semibold text-red-700 mb-1">Critical Issues:</p>
                    <ul class="list-disc list-inside text-gray-600 space-y-1">
                        ${reasons.map(r => `<li>${r}</li>`).join('')}
                    </ul>
                </div>`;
            }

            detailsDiv.innerHTML = html;
        }

        function resetForm() {
            setCourseType(currentType);
        }

        // Initialize
        setCourseType('theory');
    </script>
</body>
</html>